---
title: "HW5"
author: "Gaby Ramirez"
date: "2022-11-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(stringr)
library(readr)
library(lubridate)
library(dygraphs)
library(ggplot2)
```

# Loading the data and 
```{r}
list.files("../data")

getwd()
setwd("C:/Users/gabyrm/Desktop/HW5-Rclass/data")
homicides <- read.csv("C:/Users/gabyrm/Desktop/HW5-Rclass/data/homicide-data.csv")
```

# Separate by ymd 

```{r fig.height=7, fig.width=15}
homicides_MD <- homicides %>% 
  filter(city == "Baltimore") %>% 
  mutate(date = ymd(reported_date),
         year = year(date),
         month = month(date)) %>% 
  group_by(month, year) %>% 
  count() %>% 
  unite("date", year:month, remove = FALSE) %>% 
  mutate(date = ym(date),
         season = case_when(month >= 5 & month <= 10 ~ "Summer",
                            month < 5 ~ "Winter",
                            month > 10 ~ "Winter"),
         season = fct_relevel(season, c("Summer", "Winter")))
```


```{r}
freddie <- homicides %>% 
  filter(victim_last == "GREY") %>% 
  filter(disposition == "Closed by arrest") %>% 
  mutate(date = ymd(reported_date),
         year = year(date),
         month = month(date)) %>% 
  unite("date", year:month, remove = FALSE)
```


```{r fig.height=7, fig.width=15}
ggplot(homicides_MD) +
  geom_bar(aes(x = date, y = n, fill =  month), stat = "summary", position = "dodge2") +
  labs(x = "Date",
       y = "Monthly homicides") +
  ggtitle("Homicides in Baltimore, MD") +
  theme_dark() +
  geom_smooth(aes(x = date, y = n), colour="dodgerblue1", span = 0.15, se = FALSE, size = 2)
  geom_vline(xintercept = freddie$date, color = "red", linetype = "dashed", size = 1.5) +
  annotate("text", x = freddie_grey$month, y = 40, label="Arrest of\n Freddie Gar", angle = 0, size = 8, color = "white") 
plot(homicides_MD)
```


