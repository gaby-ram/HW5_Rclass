---
title: "HW5"
author: "Gaby Ramirez"
date: "2022-11-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(stringr)
library(readr)
library(lubridate)
install.packages("dygraphs")
library(dygraphs)
library(ggplot2)
```

# Loading the data and 
```{r}
list.files("../data")

getwd()
setwd("C:/Users/gabyrm/Desktop/HW5-Rclass/data")
homicides <- read.csv("C:/Users/gabyrm/Desktop/HW5-Rclass/data/homicide-data.csv")


data_homicides <- homicides %>% 
  mutate(city_name = paste(city, state, sep= ","))
head(data_homicides)
```

# Separate by ymd 

```{r fig.height=7, fig.width=15}
homicides_MD <- data_homicides %>% 
  filter(city_name == "Baltimore,MD") %>% 
  mutate(date = ymd(reported_date)) %>% 
  mutate_at(vars(date), funs(year, month)) %>% 
  group_by(month, year) %>% 
  count() %>% 
  ggplot(aes(x = year, y = n, fill = month)) +
  geom_col( position = "dodge2") +
  labs(x = "Date",
       y = "Monthly homicides") +
  ggtitle("Homicides in Baltimore, MD") +
  theme_gray() +
  geom_vline(yintercept = 4, linetype = 2)
plot(homicides_MD)
```
april 2015
```{r}
plot_MD <- homicides_MD %>% 
  group_by(month, year) %>% 
  count() %>% 
  ggplot(aes(x = year, y = n, fill = month)) +
  geom_col() +
  labs(x = "Date",
       y = "Monthly homicides") +
  ggtitle("Homicides in Baltimore, MD") +
  theme_classic()
plot(plot)
```

